# 保护平面模型

## Basic Flat Model（基础平面模型）

![](/static/images/2502/p003.png)

系统最简单的内存模型是基本的“平坦模型”（flat model），在这种模型中，操作系统和应用程序可以访问一个连续的、未分段的地址空间。在最大程度上，这种基本的平坦模型对系统设计者和应用程序程序员隐藏了architecture（体系结构）的segmentation mechanism（分段机制）。

为了在 IA-32 架构上实现基本的平坦内存模型，至少需要创建两个段描述符，一个用于引用代码段，另一个用于引用数据段。然而，这两个段都被映射到整个线性地址空间：也就是说，这两个段描述符都具有相同的基地址值（0）和相同的段限长（4 GB）。通过将段限长设置为 4 GB，即使某个特定地址没有物理内存，也可以防止分段机制因超出限制的内存引用而产生异常。

通常，ROM（EPROM）位于物理地址空间的顶部，因为处理器在地址 FFFF_FFF0H 开始执行。而 RAM（DRAM）则放置在地址空间的底部，因为复位初始化后 DS 数据段的初始基地址为 0。

## Protected Flat Model（保护平面模型）

![](/static/images/2502/p004.png)

受保护的平坦模型（protected flat model）与基本平坦模型类似，但段限长被设置为仅包含实际存在物理内存的地址范围。在尝试访问不存在的内存时，将生成一般保护异常（#GP）。这种模型对某些类型的程序错误提供了最低限度的硬件保护。

可以在受保护的平坦模型上增加更多复杂性，以提供更高的保护。例如，通过分页机制实现用户代码和数据与管理者（监督者）代码和数据之间的隔离，需要定义四个段：用户级别3的代码段和数据段，以及管理级别0的代码段和数据段。通常，这些段都重叠在一起，并从线性地址空间的地址0开始。

此平坦分段模型结合简单的分页结构，不仅可以保护操作系统免受应用程序的影响，还可以通过为每个任务或进程提供单独的分页结构来保护应用程序之间的相互隔离。这种设计被多个流行的多任务操作系统所采用。