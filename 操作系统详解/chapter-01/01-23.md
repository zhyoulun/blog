# MAPPING SEGMENTS TO PAGES

![](/static/images/2502/p020.png)

IA-32 架构中的分段和分页机制为内存管理提供了广泛的支持。当分段和分页结合使用时，段可以通过多种方式映射到页。例如，为了实现平坦（无分段）的寻址环境，所有代码、数据和堆栈模块可以映射到一个或多个共享相同线性地址范围的大段（最大 4GB）（参见图 3-2）。在这种情况下，段对应用程序和操作系统或执行程序基本上是透明的。如果使用分页，分页机制可以将单个线性地址空间（包含在单个段中）映射到虚拟内存中。或者，每个程序（或任务）可以拥有自己的大线性地址空间（包含在自己的段中），并通过自己的页目录和页表集映射到虚拟内存中。

段可以小于页的大小。如果其中一个段被放置在不与其他段共享的页中，则多余的内存会被浪费。例如，一个小的数据结构，如 1 字节的信号量，如果单独放置在一个页中，将占用 4KB 的空间。如果使用许多信号量，将它们打包到单个页中会更高效。

IA-32 架构不强制要求页和段的边界对齐。一个页可以包含一个段的末尾和另一个段的开头。同样，一个段可以包含一个页的末尾和另一个页的开头。

如果内存管理软件强制页和段边界之间的一些对齐，可能会更简单且更高效。例如，如果一个可以放入一个页的段被放置在两个页中，则支持访问该段的分页开销可能会增加一倍。

一种简化内存管理软件的分页和分段结合的方法是给每个段分配自己的页表，如图 3-24 所示。这种约定使段在页目录中有一个单独的条目，该条目提供对整个段分页的访问控制信息。