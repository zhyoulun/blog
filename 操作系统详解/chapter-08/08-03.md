# SOURCES OF INTERRUPTS

处理器从两个来源接收中断：
外部（硬件生成）中断。
软件生成中断。

## External Interrupts

外部中断通过处理器上的引脚或本地 APIC（高级可编程中断控制器）接收。在 Pentium 4、Intel Xeon、P6 系列和 Pentium 处理器上，主要的中断引脚是 **LINT[1:0]** 引脚，它们连接到本地 APIC（参见第 8 章“高级可编程中断控制器 (APIC)”）。当本地 APIC 启用时，可以通过 APIC 的本地向量表（LVT）对 **LINT[1:0]** 引脚进行编程，使其与处理器的任何异常或中断向量相关联。

当本地 APIC 禁用时，这些引脚分别配置为 **INTR** 和 **NMI** 引脚。**INTR** 引脚被置高时，向处理器发出信号，表示发生了外部中断，处理器从系统总线读取由外部中断控制器（如 8259A）提供的中断向量号（参见第 5.2 节“异常和中断向量”）。**NMI** 引脚被置高时，表示发生了不可屏蔽中断（NMI），该中断被分配给中断向量 2。


![](/static/images/2502/p042.png)

**注意：**  
1. **UD2** 指令是在 Pentium Pro 处理器中引入的。  
2. Intel386 处理器之后的 IA-32 处理器不会生成此异常。  
3. 此异常是在 Intel486 处理器中引入的。  
4. 此异常是在 Pentium 处理器中引入的，并在 P6 系列处理器中增强。  
5. 此异常是在 Pentium III 处理器中引入的。  

处理器的本地 APIC 通常连接到基于系统的 I/O APIC。在这种情况下，I/O APIC 引脚上接收的外部中断可以通过系统总线（Pentium 4 和 Intel Xeon 处理器）或 APIC 串行总线（P6 系列和 Pentium 处理器）定向到本地 APIC。I/O APIC 确定中断的向量号，并将该号码发送到本地 APIC。当系统包含多个处理器时，处理器还可以通过系统总线（Pentium 4 和 Intel Xeon 处理器）或 APIC 串行总线（P6 系列和 Pentium 处理器）相互发送中断。

**LINT[1:0]** 引脚在 Intel486 处理器和早期不包含片上本地 APIC 的 Pentium 处理器上不可用。相反，这些处理器具有专用的 **NMI** 和 **INTR** 引脚。对于这些处理器，外部中断通常由基于系统的中断控制器（8259A）生成，并通过 **INTR** 引脚发出信号。需要注意的是，处理器上的其他几个引脚也会导致处理器中断发生；然而，这些中断不由本章描述的中断和异常机制处理。这些引脚包括 **RESET#**、**FLUSH#**、**STPCLK#**、**SMI#**、**R/S#** 和 **INIT#** 引脚。这些引脚在特定 IA-32 处理器上的包含情况取决于具体实现。这些引脚的功能在单个处理器的数据手册中描述。**SMI#** 引脚的功能也在第 13 章“系统管理”中描述。

## Maskable Hardware Interrupts

通过 **INTR 引脚** 或 **本地 APIC** 传递给处理器的任何外部中断称为**可屏蔽硬件中断**。通过 INTR 引脚传递的可屏蔽硬件中断包括 IA-32 架构定义的所有中断向量（0 到 255）；通过本地 APIC 传递的可屏蔽硬件中断包括中断向量 16 到 255。

EFLAGS 寄存器中的 **IF 标志** 允许将所有可屏蔽硬件中断作为一个组进行屏蔽（参见第 5.8.1 节“屏蔽可屏蔽硬件中断”）。需要注意的是，当通过本地 APIC 传递中断 0 到 15 时，APIC 会指示接收到非法向量。


## Software-Generated Interrupts

**INT n** 指令允许通过提供中断向量号作为操作数从软件中生成中断。例如，**INT 35** 指令会强制隐式调用中断 35 的处理程序。

此指令可以使用 0 到 255 的任何中断向量作为参数。然而，如果使用处理器的预定义 NMI 向量，处理器的响应方式与以正常方式生成的 NMI 中断不同。如果在此指令中使用向量号 2（NMI 向量），则会调用 NMI 中断处理程序，但处理器的 NMI 处理硬件不会被激活。

**注意：**  
使用 **INT n** 指令在软件中生成的中断不能被 **EFLAGS** 寄存器中的 **IF** 标志屏蔽。