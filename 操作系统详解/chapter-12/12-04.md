# 内存管理相关寄存器

处理器提供了四个内存管理寄存器（GDTR、LDTR、IDTR 和 TR），用于指定控制分段内存管理的数据结构的位置（参见图 2-4）。提供了特殊的指令来加载和存储这些寄存器。

![](/static/images/2502/p024.png)

## Global Descriptor Table Register (GDTR)

GDTR 寄存器保存 GDT 的 32 位基地址和 16 位表限长。基地址指定 GDT 第 0 字节的线性地址；表限长指定表中的字节数。LGDT 和 SGDT 指令分别用于加载和存储 GDTR 寄存器。在处理器上电或复位时，基地址被设置为默认值 0，限长被设置为 FFFFH。作为保护模式操作处理器初始化过程的一部分，必须将新的基地址加载到 GDTR 中。有关基地址和限长字段的更多信息，请参见第 3.5.1 节 “段描述符表”。

## Local Descriptor Table Register (LDTR)

LDTR 寄存器保存 LDT 的 16 位段选择子、32 位基地址、16 位段限长和描述符属性。基地址指定 LDT 段第 0 字节的线性地址；段限长指定段中的字节数。有关基地址和限长字段的更多信息，请参见第 3.5.1 节 “段描述符表”。

LLDT 和 SLDT 指令分别用于加载和存储 LDTR 寄存器的段选择子部分。包含 LDT 的段必须在 GDT 中有一个段描述符。当 LLDT 指令将段选择子加载到 LDTR 中时，LDT 描述符中的基地址、限长和描述符属性会自动加载到 LDTR 中。

当任务切换发生时，LDTR 会自动加载为新任务的 LDT 的段选择子和描述符。在将新的 LDT 信息写入寄存器之前，LDTR 的内容不会自动保存。

在处理器上电或复位时，段选择子和基地址被设置为默认值 0，限长被设置为 FFFFH。

## Interrupt Descriptor Table Register（IDTR）

IDTR 寄存器保存 IDT 的 32 位基地址和 16 位表限长。基地址指定 IDT 第 0 字节的线性地址；表限长指定表中的字节数。LIDT 和 SIDT 指令分别用于加载和存储 IDTR 寄存器。在处理器上电或复位时，基地址被设置为默认值 0，限长被设置为 FFFFH。然后可以在处理器初始化过程中更改寄存器中的基地址和限长。有关基地址和限长字段的更多信息，请参见第 5.10 节 “中断描述符表（IDT）”。

## Task Register (TR)

任务寄存器保存当前任务的TSS的16位段选择子、32位基地址、16位段限长和描述符属性。它引用GDT中的TSS描述符。基地址指定TSS第0字节的线性地址；段限长指定TSS中的字节数。（有关任务寄存器的更多信息，请参见第6.2.3节“任务寄存器”。）  

LTR和STR指令分别用于加载和存储任务寄存器的段选择子部分。当LTR指令将段选择子加载到任务寄存器中时，TSS描述符中的基地址、限长和描述符属性会自动加载到任务寄存器中。在处理器上电或复位时，基地址被设置为默认值0，限长被设置为FFFFH。  

当任务切换发生时，任务寄存器会自动加载为新任务的TSS的段选择子和描述符。在将新的TSS信息写入寄存器之前，任务寄存器的内容不会自动保存。
