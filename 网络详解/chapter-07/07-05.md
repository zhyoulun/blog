# iptables

## iptables中的概念

> 翻译自：https://netfilter.org/projects/iptables/index.html

iptables是一个用户空间的命令行工具，用于配置Linux 2.4.x及以后的包过滤规则集（packet filter ruleset）。它的使用者是系统管理员。

因为包过滤规则集也可以用于配置NAT（Network Address Translation，网络地址转换），所以iptables也可以配置NAT。

iptables包也包含ip6tables，它用于配置IPv6的包过滤。

iptables的主要特性列表是：

- 查询包过滤规则集的内容
- 增加/删除/修改包过滤规则集中的规则
- 查询/置零包过滤规则集中每个规则的计数器

## iptables和nftables

参考：

- https://wiki.archlinux.org/title/iptables
- https://wiki.nftables.org/wiki-nftables/index.php/Main_Page
- https://github.com/coreos/go-iptables

iptables是一个过时的框架，nftables致力于提供一个现代化的替代品。

有相关网页介绍如何从iptables迁移到nftables：https://wiki.nftables.org/wiki-nftables/index.php/Moving_from_iptables_to_nftables。

但实际上iptables仍然有广泛的用途。例如项目https://github.com/coreos/go-iptables，它是一个go语言封装的iptables sdk。因为netfilter并没有提供一个好的用户空间API，tables的变更是通过setsockopt设置/替换完整的table来实现的。使用用户空间代码来修改存在的table是困难且易出错的。netfilter的开发者强烈建议使用iptables进行编程操作。go-iptables封装了iptables命令，支持追加和删除rules，创建、清理和删除chains。

## 表tables

参考：

- https://wiki.archlinux.org/title/iptables

1. raw
2. filter
3. nat
4. mangle
5. security

## 链chains

参考：

- https://wiki.archlinux.org/title/iptables

## 规则rules

参考：

- https://wiki.archlinux.org/title/iptables

## chains的遍历

参考：

- https://wiki.archlinux.org/title/iptables

