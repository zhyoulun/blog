# LVS各模式间的对比总结

## DR 模式

DR 模式的优点

- 响应数据不经过 lvs，性能高
- 对数据包修改小，信息保存完整（携带客户端源 IP）

DR 模式的缺点

- lvs 与 rs 必须在同一个物理网络（不支持跨机房）
- rs 上必须配置 lo 和其它内核参数
- 不支持端口映射

DR 模式的使用场景

- 如果对性能要求非常高，可以首选 DR 模式，而且可以透传客户端源 IP 地址。

## NAT 模式

NAT 模式优点

- 能够支持 windows 操作系统
- 支持端口映射。如果 rs 端口与 vport 不一致，lvs 除了修改目的 IP，也会修改 dport 以支持端口映射。

NAT 模式缺点

- 后端 RS 需要配置网关
- 双向流量对 lvs 负载压力比较大

NAT 模式的使用场景

如果你是 windows 系统，使用 lvs 的话，则必须选择 NAT 模式了。

## Tunnel 模式

Tunnel 模式的优点

- 单臂模式，对 lvs 负载压力小
- 对数据包修改较小，信息保存完整
- 可跨机房（不过在国内实现有难度）

Tunnel 模式的缺点

- 需要在后端服务器安装配置 ipip 模块
- 需要在后端服务器 tunl0 配置 vip
- 隧道头部的加入可能导致分片，影响服务器性能
- 隧道头部 IP 地址固定，后端服务器网卡 hash 可能不均
- 不支持端口映射

Tunnel 模式的使用场景

- 理论上，如果对转发性能要求较高，且有跨机房需求，Tunnel 可能是较好的选择。

## FullNAT模式

//todo 待整理

## 阅读更多

- [负载均衡 LVS 入门教程详解](https://blog.csdn.net/liwei0526vip/article/details/103104483)